(this["webpackJsonpweko-facet-search"]=this["webpackJsonpweko-facet-search"]||[]).push([[0],{159:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(11),r=a.n(s),i=a(6),o=a(7),l=a(15),d=a(8),u=a(13),h=(a(20),a(21),a(38)),b=a(5),f=a(161),g=a(63),j=a(4);var m=function(e){for(var t=e.values,a=e.name,n=e.labels,c=window.location.search.replace(",","%2C")||"?",s=window.location.search.substring(1).split("&"),r=0;r<s.length;r++)s[r]=decodeURIComponent(s[r]);var i=[],o=[];return t&&t.map((function(e,t){var c={label:(n[e.key]||e.key)+"("+e.doc_count+")",value:e.key};o.push(c);var r=a+"="+e.key;-1!=s.indexOf(r)&&i.push(c)})),Object(j.jsx)("div",{children:Object(j.jsx)("div",{className:"select-container",children:Object(j.jsx)(g.a,{defaultValue:i,isMulti:!0,name:"Facet_Search",ontrolShouldRenderValue:!1,onChange:function(e){!function(e){var t="";if(c.indexOf("&")>=0){for(var n=c.split("&"),s=0;s<n.length;s++)n[s].indexOf(encodeURIComponent(a)+"=")<0&&(t+="&"+n[s]);t=t.substring(1)}""!=t&&(c=t),e.map((function(e,t){var n=encodeURIComponent(a)+"="+encodeURIComponent(e.value);c+="&"+n})),c=c.replace("q=0","q="),c+=-1==c.indexOf("is_facet_search=")?"&is_facet_search=true":"",window.location.href="/search"+c}(e)},backspaceRemovesValue:!1,isClearable:!1,options:o,className:"basic-multi-select",classNamePrefix:"select"})})})},p=a(62);var v=function(e){var t=e.value,a=(e.name,e.labels);function c(e){var t=new RegExp(/^(\d{8})|(\d{6})|(\d{4})$/).exec(e),a=!1;return t.length>0&&e==t[0]&&(a=!0),a}var s,r,i={},o=[],l=window.location.search.replace(",","%2C")||"?";if(t&&t.map((function(e,t){var a;e.key.length>0&&(a=parseInt(e.key),o.push(a))})),o.length>1)for(r in o.sort(),s=100/((o=Array.from(new Set(o))).length-1),o)i[r*s]=o[r].toString();var d=Object(n.useState)(o[0]),u=Object(b.a)(d,2),h=u[0],f=u[1],g=Object(n.useState)(o[r]),m=Object(b.a)(g,2),v=m[0],O=m[1];return Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{className:"col-sm-11",style:{paddingBottom:"20px","white-space":"nowrap"},children:Object(j.jsx)(p.a.Range,{min:0,marks:i,step:s,onChange:function(e){f(i[e[0]]),O(i[e[1]])},defaultValue:[0,100]})}),Object(j.jsxs)("div",{className:"form-group row",children:[Object(j.jsx)("div",{className:"col-sm-5",children:Object(j.jsx)("input",{type:"number",id:"input_head",className:"form-control",value:h,onChange:function(e){return f(e.target.value)}})}),Object(j.jsx)("div",{className:"col-sm-5",children:Object(j.jsx)("input",{type:"number",id:"input_tail",className:"form-control",value:v,onChange:function(e){return O(e.target.value)}})}),Object(j.jsx)("div",{className:"col-sm-2",children:Object(j.jsxs)("button",{type:"button",style:{marginLeft:"3px"},className:"btn btn-primary pull-right",onClick:function(){!function(){var e="";if(l.indexOf("&")>=0){var t=l.split("&");console.log(t);for(var a=0;a<t.length;a++)t[a].indexOf(encodeURIComponent("date_range1_from")+"=")<0&&t[a].indexOf(encodeURIComponent("date_range1_to")+"=")<0&&(e+="&"+t[a]);e=e.substring(1)}""!=e&&(l=e)}();var e=parseInt(h),t=parseInt(v),a="";e&&c(e)&&(a+="&"+encodeURIComponent("date_range1_from")+"="+encodeURIComponent(e)),t&&c(t)&&(a+="&"+encodeURIComponent("date_range1_to")+"="+encodeURIComponent(t)),a&&(l+=a,window.location.href="/search"+l)},children:[" ",a.Goto]})})]})]})};function O(e){return"Time Period(s)"===e}for(var x=function(e){var t=e.item,a=e.nameshow,c=e.name,s=e.key,r=e.labels,i=window.location.search.replace(",","%2C").indexOf(encodeURIComponent(c))>=0,o=Object(n.useState)(i),l=Object(b.a)(o,2),d=l[0],u=l[1];return Object(j.jsxs)("div",{className:"panel panel-default",children:[Object(j.jsxs)("div",{className:"panel-heading clearfix",children:[Object(j.jsx)("h3",{className:"panel-title pull-left",children:a}),Object(j.jsxs)("a",{className:"pull-right",onClick:function(){return u(!d)},children:[!d&&Object(j.jsx)("span",{children:Object(j.jsx)("i",{className:"glyphicon glyphicon-chevron-right"})}),d&&Object(j.jsx)("span",{children:Object(j.jsx)("i",{className:"glyphicon glyphicon-chevron-down"})})]})]}),Object(j.jsx)(f.a,{isOpen:d,children:Object(j.jsxs)("div",{className:"panel-body index-body",children:[!O(c)&&Object(j.jsx)(m,{values:t.buckets,name:c,labels:r}),O(c)&&Object(j.jsx)(v,{value:t.buckets,name:c,labels:r})]})})]},s)},y={},k=document.getElementsByClassName("body-facet-search-label"),_=0;_<k.length;_++)y[k[_].id]=k[_].value;var w=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={is_enable:!0,list_title:{},list_facet:{},list_order:{}},n.getTitleAndOrder=n.getTitleAndOrder.bind(Object(l.a)(n)),n.get_facet_search_list=n.get_facet_search_list.bind(Object(l.a)(n)),n.convertData=n.convertData.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"getTitleAndOrder",value:function(){var e=this,t={},a={};Object(h.a)("/facet-search/get-title-and-order",{method:"POST"}).then((function(e){return e.json()})).then((function(n){n.status&&(t=n.data.titles,a=n.data.order),e.setState({list_title:t}),e.setState({list_order:a})}))}},{key:"get_facet_search_list",value:function(){var e=this,t=new URLSearchParams(window.location.search),a=2==t.get("search_type")?"/api/index/":"/api/records/";Object(h.a)(a+"?"+t.toString()).then((function(e){return e.json()})).then((function(a){if(2==t.get("search_type")){var n=a&&a.aggregations&&a.aggregations.aggregations?a.aggregations.aggregations[0]:{};e.convertData(n)}else e.convertData(a&&a.aggregations?a.aggregations:{})}))}},{key:"convertData",value:function(e){var t={};e&&Object.keys(e).map((function(a,n){var c=e[a][a]?e[a][a]:e[a],s=c.key&&c.key.hasOwnProperty("buckets");if(s=c.hasOwnProperty("buckets")||s){if(t[a]=c[a]?c[a]:c,"Time Period(s)"!=a&&"Data Language"!=a&&"Access"!=a)for(var r=document.getElementById("lang-code"),i=r.options[r.selectedIndex].value,o=t[a],l=0;l<o.buckets.length;l++){var d=o.buckets[l];("en"==i&&(d.key.charCodeAt(0)>256||d.key.charCodeAt(d.key.length-1)>256)||"en"!=i&&d.key.charCodeAt(0)<256&&d.key.charCodeAt(d.key.length-1)<256)&&delete t[a].buckets[l]}if("Access"==a)for(var u=t[a],h=0;h<u.buckets.length;h++){var b=u.buckets[h];(b.key.charCodeAt(0)>256||b.key.charCodeAt(b.key.length-1)>256)&&delete t[a].buckets[h]}}})),this.setState({list_facet:t})}},{key:"componentDidMount",value:function(){this.getTitleAndOrder(),this.get_facet_search_list()}},{key:"render",value:function(){var e=this.state,t=e.is_enable,a=e.list_title,n=e.list_facet,c=e.list_order;return Object(j.jsx)("div",{children:t&&Object(j.jsx)("div",{className:"facet-search break-word",children:Object.keys(c).map((function(e,t){var s=c[e],r=n[s],i=a[s];return Object(j.jsx)(x,{item:r,nameshow:i,name:s,labels:y},t)}))})})}}]),a}(c.a.Component);r.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(w,{})}),document.getElementById("app-facet-search"))}},[[159,1,2]]]);
//# sourceMappingURL=main.257c370d.chunk.js.map